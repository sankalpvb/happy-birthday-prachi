<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Happy Birthday Prachi 🎉</title>
    <!-- Tone.js for generating music -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/tone/14.7.77/Tone.js"></script>
    <style>
        :root {
            --bg1: #ffe4ec;
            /* pastel pink */
            --bg2: #d7ecff;
            /* baby blue */
            --bg3: #fff7d6;
            /* soft yellow */
            --accent: #ff4d8d;
            /* rose */
            --accent-2: #7c4dff;
            /* violet */
            --text: #2c2c2c;
        }

        * {
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }

        html,
        body {
            height: 100%;
            margin: 0;
            font-family: system-ui, -apple-system, Segoe UI, Roboto, Inter, Ubuntu, "Helvetica Neue", Arial, sans-serif;
            background: linear-gradient(135deg, var(--bg1), var(--bg2) 60%, var(--bg3));
            color: var(--text);
        }

        .app {
            min-height: 100dvh;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
            overflow: hidden;
            position: relative;
        }

        /* Sparkle background */
        .sparkles::before,
        .sparkles::after {
            content: "";
            position: absolute;
            inset: -20% -20%;
            background: radial-gradient(circle at 20% 30%, rgba(255, 255, 255, .6), transparent 40%),
                radial-gradient(circle at 80% 20%, rgba(255, 255, 255, .5), transparent 45%),
                radial-gradient(circle at 30% 80%, rgba(255, 255, 255, .4), transparent 40%),
                radial-gradient(circle at 70% 70%, rgba(255, 255, 255, .5), transparent 45%);
            filter: blur(1px);
            animation: twinkle 6s linear infinite;
            pointer-events: none;
        }

        .sparkles::after {
            animation-duration: 9s;
            opacity: .7;
        }

        @keyframes twinkle {
            0% {
                transform: translateY(0);
            }

            50% {
                transform: translateY(-10px);
            }

            100% {
                transform: translateY(0);
            }
        }

        /* Card shells */
        .screen {
            width: 100%;
            max-width: 480px;
            border-radius: 24px;
            background: rgba(255, 255, 255, .7);
            backdrop-filter: blur(10px);
            box-shadow: 0 20px 60px rgba(0, 0, 0, .15);
            padding: 24px;
            position: relative;
        }

        .hidden {
            display: none;
        }

        h1,
        h2,
        p {
            margin: 0;
        }

        .center {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 16px;
            text-align: center;
        }

        /* Fancy title */
        .title {
            font-weight: 900;
            letter-spacing: .5px;
            line-height: 1.2;
            display: flex;
            /* Use flexbox for layout */
            flex-direction: column;
            /* Stack words vertically */
            align-items: center;
            /* Center words */
        }

        .title .word {
            display: block;
            /* Each word is a block */
        }

        .title span {
            display: inline-block;
            animation: pop .9s cubic-bezier(0.175, 0.885, 0.32, 1.275) both;
        }

        .title .word:nth-of-type(2) span,
        .title .word:nth-of-type(4) span {
            color: var(--accent);
        }

        /* Happy, Prachi */
        .title .word:nth-of-type(3) span {
            color: var(--accent-2);
        }

        /* Birthday */
        .badge {
            display: inline-block;
            margin-bottom: 8px;
            padding: 8px 14px;
            border-radius: 999px;
            background: linear-gradient(90deg, #ff9ac0, #a395ff);
            color: white;
            font-size: .9rem;
            font-weight: 600;
        }

        @keyframes pop {
            0% {
                transform: translateY(15px) scale(.9);
                opacity: 0;
            }

            60% {
                transform: translateY(-8px) scale(1.05);
                opacity: 1;
            }

            100% {
                transform: translateY(0) scale(1);
            }
        }

        /* Buttons */
        .btn {
            appearance: none;
            border: 0;
            background: linear-gradient(90deg, #ff78a5, #9b82ff);
            color: white;
            padding: 14px 20px;
            border-radius: 16px;
            font-weight: 700;
            font-size: 1rem;
            box-shadow: 0 8px 20px rgba(155, 130, 255, .35);
            cursor: pointer;
            transition: transform 0.2s;
        }

        .btn:active {
            transform: translateY(2px) scale(0.98);
        }

        .btn-secondary {
            background: white;
            color: var(--accent);
            border: 2px solid #ffd2e3;
            box-shadow: none;
        }

        /* Step indicators */
        .steps {
            display: flex;
            gap: 8px;
            justify-content: center;
            margin-bottom: 12px;
        }

        .dot {
            width: 10px;
            height: 10px;
            border-radius: 50%;
            background: #e5dfff;
            transition: background 0.3s;
        }

        .dot.active {
            background: linear-gradient(90deg, #ff78a5, #9b82ff);
        }

        /* Carousel */
        .carousel-wrap {
            margin: 12px 0;
            width: 100%;
            overflow: hidden;
            border-radius: 18px;
        }

        .carousel {
            display: flex;
            gap: 12px;
            scroll-snap-type: x mandatory;
            overflow-x: auto;
            padding-bottom: 8px;
        }

        .slide {
            min-width: 85%;
            aspect-ratio: 4/3;
            scroll-snap-align: center;
            border-radius: 18px;
            background: #fff;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
            box-shadow: 0 8px 24px rgba(0, 0, 0, .12);
        }

        .slide img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            border-radius: 18px;
        }

        .carousel::-webkit-scrollbar {
            height: 8px;
        }

        .carousel::-webkit-scrollbar-thumb {
            background: #e9e2ff;
            border-radius: 999px;
        }

        .controls {
            display: flex;
            justify-content: space-between;
            gap: 12px;
            width: 100%;
            margin-top: 12px;
        }

        /* Celebration screen */
        .cake {
            position: relative;
            display: grid;
            place-items: center;
            margin-top: 12px;
        }

        .cake-emoji {
            font-size: 4.5rem;
            filter: drop-shadow(0 12px 22px rgba(0, 0, 0, .2));
        }

        .candles {
            position: absolute;
            top: 10px;
            display: flex;
            gap: 16px;
        }

        .flame {
            width: 10px;
            height: 18px;
            background: radial-gradient(ellipse at center, #ffd479 25%, #ff9a3c 58%, rgba(255, 154, 60, .6) 80%, transparent 100%);
            border-radius: 50%;
            animation: flicker .9s infinite alternate;
            filter: blur(.5px);
            transition: opacity 0.5s;
        }

        @keyframes flicker {
            from {
                transform: translateY(0) scale(1);
            }

            to {
                transform: translateY(-3px) scale(1.05);
            }
        }

        .puff {
            position: absolute;
            top: -8px;
            width: 45px;
            height: 45px;
            border-radius: 50%;
            background: radial-gradient(circle, rgba(255, 255, 255, .85), rgba(255, 255, 255, .1));
            opacity: 0;
            transform: scale(.6);
            pointer-events: none;
        }

        .puff.show {
            animation: puff 1s ease-out forwards;
        }

        @keyframes puff {
            0% {
                opacity: .9;
                transform: scale(.6);
            }

            100% {
                opacity: 0;
                transform: scale(2.2);
            }
        }

        .candles.off .flame {
            opacity: 0;
            animation: none;
        }

        /* Confetti */
        .confetti {
            pointer-events: none;
            position: absolute;
            top: -10px;
            width: 8px;
            height: 12px;
            opacity: .9;
            animation: fall linear forwards;
        }

        @keyframes fall {
            to {
                transform: translateY(110dvh) rotate(540deg);
                opacity: 1;
            }
        }

        /* Balloons */
        .balloon {
            position: absolute;
            bottom: -60px;
            width: 28px;
            height: 36px;
            border-radius: 50% 50% 45% 55%;
            background: radial-gradient(circle at 30% 30%, #fff6, transparent 60%), var(--color, #ff9fb3);
            animation: floatUp var(--dur, 9s) linear infinite;
            box-shadow: 0 8px 16px rgba(0, 0, 0, .12);
        }

        .balloon::after {
            content: "";
            position: absolute;
            bottom: -10px;
            left: 50%;
            width: 2px;
            height: 18px;
            background: #999;
            transform: translateX(-50%);
        }

        @keyframes floatUp {
            0% {
                transform: translateY(0);
            }

            100% {
                transform: translateY(-110dvh);
            }
        }

        /* Flip card */
        .flip-wrap {
            perspective: 1000px;
            margin-top: 16px;
            width: 100%;
        }

        .flip {
            position: relative;
            width: 100%;
            border-radius: 18px;
            min-height: 140px;
            transform-style: preserve-3d;
            transition: transform .7s cubic-bezier(0.25, 1, 0.5, 1);
        }

        .flip.is-flipped {
            transform: rotateY(180deg);
        }

        .face {
            position: absolute;
            inset: 0;
            background: white;
            border-radius: 18px;
            display: grid;
            place-items: center;
            padding: 20px;
            backface-visibility: hidden;
            box-shadow: 0 10px 24px rgba(0, 0, 0, .12);
        }

        .back {
            transform: rotateY(180deg);
        }

        /* Footer controls */
        .footer {
            display: flex;
            gap: 12px;
            flex-wrap: wrap;
            justify-content: center;
            margin-top: 16px;
        }

        /* Utility */
        .muted {
            opacity: .7;
            font-size: .9rem;
            margin-top: 8px;
        }

        .small {
            font-size: .9rem;
        }
    </style>
</head>

<body>
    <div class="app sparkles">
        <div class="screen" id="step1">
            <div class="steps"><span class="dot active"></span><span class="dot"></span><span class="dot"></span></div>
            <div class="center">
                <div class="badge">✨ A Special Day for a Special Soul ✨</div>
                <h1 class="title" id="title"></h1>
                <div class="footer">
                    <button class="btn" id="next1">Next →</button>
                </div>
            </div>
        </div>

        <div class="screen hidden" id="step2">
            <div class="steps"><span class="dot"></span><span class="dot active"></span><span class="dot"></span></div>
            <div class="center">
                <h2>Memories & Smiles 📸</h2>
                <p class="small muted">A few happy moments to cherish!</p>
                <div class="carousel-wrap">
                    <div class="carousel" id="carousel">
                        <div class="slide"><img alt="Balloons" src="assests/1.jpg?q=80&w=1200&auto=format&fit=crop" />
                        </div>
                        <div class="slide"><img alt="Cake" src="assests/2.jpg?q=80&w=1200&auto=format&fit=crop" />
                        </div>
                        <div class="slide"><img alt="Confetti" src="assests/3.jpg?q=80&w=1200&auto=format&fit=crop" />
                        </div>
                        <div class="slide"><img alt="Confetti" src="assests/4.jpg?q=80&w=1200&auto=format&fit=crop" />
                        </div>
                    </div>
                </div>
                <div class="controls">
                    <button class="btn-secondary btn" id="prev">◀︎ Prev</button>
                    <button class="btn" id="next2">Next →</button>
                </div>
            </div>
        </div>

        <div class="screen hidden celebration" id="step3">
            <div class="steps"><span class="dot"></span><span class="dot"></span><span class="dot active"></span></div>
            <div class="center">
                <h2>🎉 Celebration Time 🎉</h2>
                <div class="cake">
                    <div class="candles" id="candles">
                        <div class="flame"></div>
                        <div class="flame"></div>
                        <div class="flame"></div>
                    </div>
                    <div class="cake-emoji" id="cake" aria-label="cake" role="img">🎂</div>
                    <div class="puff" id="puff"></div>
                </div>
                <div class="flip-wrap">
                    <div class="flip" id="flip">
                        <div class="face front"><strong>🎁 Wishes!</strong> Tap to open</div>
                        <div class="face back">🌸 “Janm Dinachya Hardik Shubhechha Prachi… Ji
                            Tumchya ayushyacha pratek shwas Anandane bharun jao.
                            Datarachya rehmetine, Tumchya manala hava asel te sarv Tumchyakade yeo.
                            Tumhi divasen divas pragati ptavr agresar raho hich Sadechh 🌿💫
                        </div>
                    </div>
                </div>
                <div class="footer">
                    <button class="btn" id="blow">Blow Candles 🎂</button>
                    <button class="btn-secondary btn" id="music">Play Music 🎶</button>
                    <a href="https://sankalpvb.github.io/MyStuf/gift.html" class="btn" id="gift-link" target="_blank">Gift For You</a>
                </div>
                <p class="muted">Made with love · Happy Birthday Prachi</p>
            </div>
        </div>


        <div id="fx-layer" style="position:absolute;inset:0;pointer-events:none"></div>
        <div id="balloons" style="position:absolute;inset:0;pointer-events:none"></div>
    </div>

    <script>
        const $ = (q, ctx = document) => ctx.querySelector(q);
        const $$ = (q, ctx = document) => Array.from(ctx.querySelectorAll(q));
        const steps = [$('#step1'), $('#step2'), $('#step3')];
        let step = 0;

        function showStep(i) {
            steps.forEach((el, idx) => { el.classList.toggle('hidden', idx !== i); });
            step = i;
        }

        $('#next1').addEventListener('click', () => showStep(1));
        $('#next2').addEventListener('click', () => showStep(2));
        $('#prev').addEventListener('click', () => {
            const c = $('#carousel');
            c.scrollBy({ left: -c.clientWidth * 0.9, behavior: 'smooth' });
        });

        // --- FIX FOR TITLE ---
        const titleHost = $('#title');
        const titleWords = ['Happy', 'Birthday', 'Prachi', 'Ji'];
        let charCount = 0;
        titleWords.forEach(word => {
            const wordDiv = document.createElement('div');
            wordDiv.className = 'word';
            // Set font size for the whole word/emoji
            const isEmoji = word === '🎂' || word === '🎉';
            const fontSize = window.innerWidth < 420 ? '1.8rem' : '2.2rem';
            wordDiv.style.fontSize = isEmoji ? `calc(${fontSize} * 1.3)` : fontSize;

            word.split('').forEach(char => {
                const span = document.createElement('span');
                span.textContent = char;
                span.style.animationDelay = (charCount * 0.05) + 's';
                wordDiv.appendChild(span);
                charCount++;
            });
            titleHost.appendChild(wordDiv);
        });
        // --- END FIX ---

        setTimeout(() => {
            const c = $('#carousel');
            if (c) c.scrollBy({ left: c.clientWidth * 0.5, behavior: 'smooth' });
        }, 1200);

        const fx = $('#fx-layer');
        function makeConfetti(count = 60) {
            for (let i = 0; i < count; i++) {
                const d = document.createElement('div');
                d.className = 'confetti';
                d.style.left = Math.random() * 100 + '%';
                d.style.animationDuration = (3 + Math.random() * 3) + 's';
                d.style.background = ['#ff78a5', '#ffd166', '#7c4dff', '#4dd4b3'][Math.floor(Math.random() * 4)];
                fx.appendChild(d);
                setTimeout(() => d.remove(), 7000);
            }
        }

        const balloonLayer = $('#balloons');
        function launchBalloons(n = 10) {
            for (let i = 0; i < n; i++) {
                const b = document.createElement('div');
                b.className = 'balloon';
                const hue = Math.floor(Math.random() * 360);
                b.style.setProperty('--color', `hsl(${hue} 85% 75%)`);
                b.style.left = (5 + Math.random() * 90) + '%';
                b.style.animationDelay = (Math.random() * 3) + 's';
                b.style.setProperty('--dur', (8 + Math.random() * 6) + 's');
                balloonLayer.appendChild(b);
                setTimeout(() => b.remove(), 15000);
            }
        }

        const observer = new MutationObserver(() => {
            if (!steps[2].classList.contains('hidden')) {
                makeConfetti(80);
                launchBalloons(12);
                setTimeout(() => { makeConfetti(40); launchBalloons(8); }, 1500);
            }
        });
        observer.observe(document.body, { subtree: true, attributes: true, attributeFilter: ['class'] });

        const candles = $('#candles');
        const puff = $('#puff');
        $('#blow').addEventListener('click', () => {
            candles.classList.add('off');
            puff.classList.add('show');
            setTimeout(() => puff.classList.remove('show'), 1200);
            makeConfetti(60);
            launchBalloons(10);
        });
        $('#cake').addEventListener('click', () => {
            candles.classList.toggle('off');
        });

        const flip = $('#flip');
        flip.addEventListener('click', () => flip.classList.toggle('is-flipped'));

        // Music controls with Tone.js
        const musicBtn = $('#music');
        let synth, musicLoop, isMusicPlaying = false;

        async function toggleMusic() {
            if (!synth) {
                await Tone.start();
                synth = new Tone.PolySynth(Tone.Synth, {
                    oscillator: { type: "sine" },
                    envelope: { attack: 0.02, decay: 0.1, sustain: 0.3, release: 1 }
                }).toDestination();
                synth.volume.value = -8;

                const melody = ["G4", "G4", "A4", "G4", "C5", "B4", null, "G4", "G4", "A4", "G4", "D5", "C5"];
                let step = 0;
                musicLoop = new Tone.Loop(time => {
                    const note = melody[step % melody.length];
                    if (note) synth.triggerAttackRelease(note, "8n", time);
                    step++;
                }, "4n").start(0);
            }

            if (isMusicPlaying) {
                Tone.Transport.pause();
                isMusicPlaying = false;
                musicBtn.textContent = 'Play Music 🎶';
            } else {
                Tone.Transport.start();
                isMusicPlaying = true;
                musicBtn.textContent = 'Pause Music ⏸️';
            }
        }
        musicBtn.addEventListener('click', toggleMusic);
    </script>
</body>

</html>
